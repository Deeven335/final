import React, { useEffect, useMemo, useState } from "react";
import { motion, useScroll, useTransform } from "framer-motion";
import {
  Github,
  Linkedin,
  Mail,
  Moon,
  Sun,
  ExternalLink,
  FileDown,
  Globe,
  Phone,
  MapPin,
  ArrowRight,
} from "lucide-react";

// ---------- THEME / UTIL ----------
const useDarkMode = () => {
  const [dark, setDark] = useState(() => {
    if (typeof window === "undefined") return false;
    const saved = localStorage.getItem("prefers-dark");
    if (saved !== null) return saved === "true";
    return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  });
  useEffect(() => {
    localStorage.setItem("prefers-dark", String(dark));
    const root = document.documentElement;
    if (dark) root.classList.add("dark");
    else root.classList.remove("dark");
  }, [dark]);
  return { dark, setDark };
};

const cx = (...classes) => classes.filter(Boolean).join(" ");

// ---------- DATA (EDIT HERE) ----------
const PROFILE = {
  name: "Your Name",
  title: "Full‑Stack Developer",
  blurb:
    "I build delightful, accessible web apps with React, TypeScript, and a sprinkle of motion.",
  location: "Hyderabad, India",
  email: "you@example.com",
  phone: "+91 98765 43210",
  socials: {
    github: "https://github.com/yourhandle",
    linkedin: "https://linkedin.com/in/yourhandle",
    website: "https://yourdomain.com",
  },
};

const SKILLS = [
  { name: "React", level: 90 },
  { name: "TypeScript", level: 85 },
  { name: "Next.js", level: 80 },
  { name: "Node.js", level: 80 },
  { name: "Tailwind", level: 85 },
  { name: "Python", level: 70 },
  { name: "SQL", level: 70 },
];

const PROJECTS = [
  {
    title: "ChromaBoard",
    description:
      "A realtime whiteboard with multiplayer cursors, infinite canvas, and emoji reactions.",
    tags: ["Next.js", "WebSockets", "Tailwind"],
    link: "https://example.com",
    repo: "https://github.com/yourhandle/chromaboard",
    image:
      "data:image/svg+xml;utf8,\
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 400'>\
        <defs>\
          <linearGradient id='g' x1='0' x2='1'>\
            <stop offset='0%' stop-color='%234f46e5'/>\
            <stop offset='100%' stop-color='%23a855f7'/>\
          </linearGradient>\
        </defs>\
        <rect width='800' height='400' fill='url(%23g)'/>\
        <g fill='white' opacity='0.9'>\
          <circle cx='120' cy='120' r='20'/>\
          <rect x='200' y='90' width='420' height='20' rx='10'/>\
          <rect x='200' y='130' width='360' height='20' rx='10'/>\
          <rect x='200' y='170' width='300' height='20' rx='10'/>\
          <rect x='200' y='220' width='420' height='120' rx='14'/>\
        </g>\
      </svg>",
  },
  {
    title: "PocketChef AI",
    description:
      "An AI recipe generator that turns what’s in your fridge into dinner—beautiful UI included.",
    tags: ["React", "Vite", "OpenAI"],
    link: "https://example.com",
    repo: "https://github.com/yourhandle/pocketchef",
    image:
      "data:image/svg+xml;utf8,\
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 400'>\
        <defs><linearGradient id='g2' x1='0' x2='1'><stop offset='0%' stop-color='%230ea5e9'/><stop offset='100%' stop-color='%2306b6d4'/></linearGradient></defs>\
        <rect width='800' height='400' fill='url(%23g2)'/>\
        <g fill='white' opacity='0.9'>\
          <rect x='70' y='70' width='660' height='260' rx='18'/>\
          <circle cx='160' cy='200' r='60'/>\
          <rect x='260' y='160' width='380' height='25' rx='8'/>\
          <rect x='260' y='205' width='300' height='25' rx='8'/>\
        </g>\
      </svg>",
  },
  {
    title: "GreenTrack",
    description:
      "Track your carbon footprint and get weekly challenges—gamified and privacy‑first.",
    tags: ["SvelteKit", "Supabase", "Charts"],
    link: "https://example.com",
    repo: "https://github.com/yourhandle/greentrack",
    image:
      "data:image/svg+xml;utf8,\
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 400'>\
        <defs><linearGradient id='g3' x1='0' x2='1'><stop offset='0%' stop-color='%23059669'/><stop offset='100%' stop-color='%2322c55e'/></linearGradient></defs>\
        <rect width='800' height='400' fill='url(%23g3)'/>\
        <g fill='white' opacity='0.9'>\
          <rect x='100' y='80' width='600' height='240' rx='16'/>\
          <rect x='140' y='120' width='300' height='20' rx='6'/>\
          <rect x='140' y='160' width='420' height='20' rx='6'/>\
          <rect x='140' y='200' width='220' height='20' rx='6'/>\
        </g>\
      </svg>",
  },
];

const EXPERIENCE = [
  {
    role: "Software Engineer",
    company: "Acme Corp",
    period: "2023 — Present",
    details: [
      "Built a design system adopted across 8+ teams",
      "Improved lighthouse performance from 62 → 95",
    ],
  },
  {
    role: "Frontend Developer",
    company: "Pixel Labs",
    period: "2021 — 2023",
    details: [
      "Shipped 12+ features across 3 products",
      "Led migration from CRA to Vite",
    ],
  },
];

// ---------- REUSABLES ----------
const Section = ({ id, title, children, className }) => (
  <section id={id} className={cx("py-20", className)}>
    <div className="max-w-6xl mx-auto px-6">
      <div className="flex items-baseline gap-3 mb-10">
        <div className="w-10 h-1 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500" />
        <h2 className="text-2xl sm:text-3xl font-bold tracking-tight dark:text-white">{title}</h2>
      </div>
      {children}
    </div>
  </section>
);

const Chip = ({ children }) => (
  <span className="px-2.5 py-1 text-xs rounded-full bg-neutral-100 dark:bg-neutral-800 dark:text-neutral-300 text-neutral-700 border border-neutral-200 dark:border-neutral-700">
    {children}
  </span>
);

const Button = ({ as: As = "a", href = "#", children, className, icon: Icon, ...rest }) => (
  <As
    href={href}
    className={cx(
      "inline-flex items-center gap-2 rounded-2xl px-4 py-2 text-sm font-medium border",
      "border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900",
      "shadow-sm hover:shadow transition-shadow",
      "hover:border-neutral-300 dark:hover:border-neutral-700",
      className
    )}
    {...rest}
  >
    {children}
    {Icon ? <Icon className="w-4 h-4" /> : null}
  </As>
);

// ---------- DECOR: PARALLAX BLOB ----------
const Background = () => {
  const { scrollY } = useScroll();
  const y1 = useTransform(scrollY, [0, 600], [0, -60]);
  const y2 = useTransform(scrollY, [0, 600], [0, 80]);
  return (
    <div aria-hidden className="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
      <motion.div
        style={{ y: y1 }}
        className="absolute -top-24 -left-16 h-80 w-80 rounded-full blur-3xl opacity-30 bg-gradient-to-br from-indigo-400 to-fuchsia-400 dark:opacity-20"
      />
      <motion.div
        style={{ y: y2 }}
        className="absolute -bottom-24 -right-16 h-80 w-80 rounded-full blur-3xl opacity-30 bg-gradient-to-br from-cyan-400 to-emerald-400 dark:opacity-20"
      />
    </div>
  );
};

// ---------- CURSOR ----------
const CometCursor = () => {
  const [pos, setPos] = useState({ x: -100, y: -100 });
  useEffect(() => {
    const move = (e) => setPos({ x: e.clientX, y: e.clientY });
    window.addEventListener("mousemove", move);
    return () => window.removeEventListener("mousemove", move);
  }, []);
  return (
    <div
      aria-hidden
      className="pointer-events-none fixed -z-10 inset-0"
      style={{ contain: "strict" }}
    >
      <motion.div
        className="w-36 h-36 rounded-full bg-gradient-to-br from-indigo-500/30 to-fuchsia-500/30 blur-2xl"
        animate={{ x: pos.x - 72, y: pos.y - 72 }}
        transition={{ type: "spring", stiffness: 120, damping: 20, mass: 0.2 }}
      />
    </div>
  );
};

// ---------- MAIN APP ----------
export default function Portfolio() {
  const { dark, setDark } = useDarkMode();
  const initials = useMemo(
    () =>
      PROFILE.name
        .split(" ")
        .map((n) => n[0]?.toUpperCase())
        .join(""),
    []
  );

  return (
    <div className="min-h-screen bg-neutral-50 text-neutral-800 dark:bg-neutral-950 dark:text-neutral-200 selection:bg-fuchsia-300/40 selection:text-neutral-900">
      <Background />
      <CometCursor />

      {/* NAVBAR */}
      <header className="sticky top-0 z-30 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-neutral-950/50 border-b border-neutral-200/60 dark:border-neutral-800">
        <div className="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
          <a href="#home" className="flex items-center gap-3 group">
            <div className="grid place-items-center w-9 h-9 rounded-2xl bg-gradient-to-br from-indigo-500 to-fuchsia-500 text-white font-bold shadow">
              {initials || "YN"}
            </div>
            <span className="font-semibold group-hover:opacity-80">{PROFILE.name}</span>
          </a>
          <nav className="hidden sm:flex items-center gap-6 text-sm">
            <a href="#about" className="hover:opacity-80">About</a>
            <a href="#projects" className="hover:opacity-80">Projects</a>
            <a href="#experience" className="hover:opacity-80">Experience</a>
            <a href="#contact" className="hover:opacity-80">Contact</a>
            <a
              href={PROFILE.socials.github}
              target="_blank"
              rel="noreferrer"
              className="hover:opacity-80"
            >
              GitHub
            </a>
          </nav>
          <div className="flex items-center gap-3">
            <Button as="button" onClick={() => setDark((d) => !d)} className="!px-3 !py-2">
              {dark ? <Sun className="w-4 h-4" /> : <Moon className="w-4 h-4" />}
            </Button>
            <Button href="#" icon={FileDown}>
              Resume
            </Button>
          </div>
        </div>
      </header>

      {/* HERO */}
      <section id="home" className="relative py-24">
        <div className="max-w-6xl mx-auto px-6 grid md:grid-cols-2 items-center gap-12">
          <div>
            <motion.h1
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.6 }}
              className="text-4xl sm:text-5xl font-black tracking-tight leading-tight"
            >
              {PROFILE.name}
              <span className="block mt-2 text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-fuchsia-500">
                {PROFILE.title}
              </span>
            </motion.h1>
            <p className="mt-6 text-base/7 text-neutral-600 dark:text-neutral-300 max-w-prose">
              {PROFILE.blurb}
            </p>
            <div className="mt-8 flex flex-wrap gap-3">
              <Button href="#projects" icon={ArrowRight} className="bg-neutral-900 text-white dark:bg-white dark:text-neutral-900 border-transparent hover:opacity-90">
                View Work
              </Button>
              <Button href="#contact">Contact Me</Button>
            </div>
            <div className="mt-8 flex items-center gap-4">
              <a href={PROFILE.socials.github} target="_blank" rel="noreferrer" className="p-2 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:shadow">
                <Github className="w-5 h-5" />
              </a>
              <a href={PROFILE.socials.linkedin} target="_blank" rel="noreferrer" className="p-2 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:shadow">
                <Linkedin className="w-5 h-5" />
              </a>
              <a href={`mailto:${PROFILE.email}`} className="p-2 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:shadow">
                <Mail className="w-5 h-5" />
              </a>
              <a href={PROFILE.socials.website} target="_blank" rel="noreferrer" className="p-2 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:shadow">
                <Globe className="w-5 h-5" />
              </a>
            </div>
          </div>
          <motion.div
            initial={{ opacity: 0, scale: 0.95 }}
            animate={{ opacity: 1, scale: 1 }}
            transition={{ duration: 0.6, delay: 0.1 }}
            className="relative"
          >
            <div className="aspect-square rounded-3xl bg-gradient-to-br from-indigo-500/10 to-fuchsia-500/10 p-2 border border-neutral-200 dark:border-neutral-800">
              <div className="h-full w-full rounded-2xl bg-white dark:bg-neutral-900 grid place-items-center text-center p-10">
                <div>
                  <div className="mx-auto w-28 h-28 rounded-full bg-gradient-to-br from-indigo-500 to-fuchsia-500 text-white grid place-items-center text-3xl font-extrabold shadow" aria-hidden>
                    {initials}
                  </div>
                  <p className="mt-6 text-sm text-neutral-600 dark:text-neutral-300">Open to opportunities • Remote / On‑site</p>
                </div>
              </div>
            </div>
          </motion.div>
        </div>
      </section>

      {/* ABOUT */}
      <Section id="about" title="About Me">
        <div className="grid md:grid-cols-3 gap-10">
          <div className="md:col-span-2 text-neutral-700 dark:text-neutral-300">
            <p>
              I’m a developer with a product mindset. I care about performance, accessibility, and pixel‑perfect details.
              I enjoy turning complex problems into simple, beautiful interfaces.
            </p>
            <p className="mt-4">
              Outside of code, you’ll find me sipping filter coffee, sketching UI ideas, or mentoring juniors.
            </p>
            <div className="mt-6 flex items-center gap-4 text-sm">
              <div className="flex items-center gap-2"><MapPin className="w-4 h-4" /> {PROFILE.location}</div>
              <a className="flex items-center gap-2 hover:underline" href={`tel:${PROFILE.phone}`}><Phone className="w-4 h-4" /> {PROFILE.phone}</a>
              <a className="flex items-center gap-2 hover:underline" href={`mailto:${PROFILE.email}`}><Mail className="w-4 h-4" /> {PROFILE.email}</a>
            </div>
          </div>
          <div>
            <div className="rounded-2xl border border-neutral-200 dark:border-neutral-800 p-5">
              <h3 className="font-semibold mb-4">Skills</h3>
              <ul className="space-y-3">
                {SKILLS.map((s) => (
                  <li key={s.name}>
                    <div className="flex justify-between text-sm mb-1">
                      <span>{s.name}</span>
                      <span className="text-neutral-500">{s.level}%</span>
                    </div>
                    <div className="h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden">
                      <div
                        className="h-full bg-gradient-to-r from-indigo-500 to-fuchsia-500"
                        style={{ width: `${s.level}%` }}
                      />
                    </div>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        </div>
      </Section>

      {/* PROJECTS */}
      <Section id="projects" title="Featured Projects">
        <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {PROJECTS.map((p) => (
            <motion.article
              key={p.title}
              whileHover={{ y: -4 }}
              className="group rounded-2xl overflow-hidden border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 shadow-sm"
            >
              <div className="aspect-video overflow-hidden">
                <img src={p.image} alt="Project preview" className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105" />
              </div>
              <div className="p-5">
                <h3 className="font-semibold text-lg">{p.title}</h3>
                <p className="mt-2 text-sm text-neutral-600 dark:text-neutral-400 line-clamp-3">{p.description}</p>
                <div className="mt-3 flex flex-wrap gap-2">
                  {p.tags.map((t) => (
                    <Chip key={t}>{t}</Chip>
                  ))}
                </div>
                <div className="mt-4 flex items-center gap-3">
                  <Button href={p.link} target="_blank" rel="noreferrer" icon={ExternalLink}>
                    Live
                  </Button>
                  <Button href={p.repo} target="_blank" rel="noreferrer">
                    Code
                  </Button>
                </div>
              </div>
            </motion.article>
          ))}
        </div>
      </Section>

      {/* EXPERIENCE */}
      <Section id="experience" title="Experience">
        <div className="relative before:content-[''] before:absolute before:left-4 sm:before:left-1/2 before:-translate-x-1/2 before:top-0 before:bottom-0 before:w-0.5 before:bg-neutral-200 dark:before:bg-neutral-800">
          <ul className="space-y-10">
            {EXPERIENCE.map((e, i) => (
              <li key={e.company} className="relative sm:flex gap-8">
                <div className="absolute left-4 sm:left-1/2 sm:-translate-x-1/2 top-2 w-3.5 h-3.5 rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500 border-2 border-white dark:border-neutral-900" />
                <div className="sm:w-1/2 sm:text-right sm:pr-10">
                  <p className="text-sm text-neutral-500">{e.period}</p>
                </div>
                <div className="sm:w-1/2 sm:pl-10">
                  <h3 className="font-semibold">{e.role} • {e.company}</h3>
                  <ul className="mt-2 list-disc list-inside text-sm text-neutral-600 dark:text-neutral-300 space-y-1">
                    {e.details.map((d) => (
                      <li key={d}>{d}</li>
                    ))}
                  </ul>
                </div>
              </li>
            ))}
          </ul>
        </div>
      </Section>

      {/* CONTACT */}
      <Section id="contact" title="Let’s work together">
        <div className="grid md:grid-cols-2 gap-8">
          <div className="rounded-2xl border border-neutral-200 dark:border-neutral-800 p-6">
            <form
              onSubmit={(e) => {
                e.preventDefault();
                const form = e.currentTarget;
                const data = Object.fromEntries(new FormData(form).entries());
                alert(`Thanks ${data.name}! I will get back to you at ${data.email}.`);
                form.reset();
              }}
              className="space-y-4"
            >
              <div>
                <label className="block text-sm mb-1">Name</label>
                <input name="name" required className="w-full rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 px-3 py-2 outline-none focus:ring-2 focus:ring-fuchsia-400" />
              </div>
              <div>
                <label className="block text-sm mb-1">Email</label>
                <input type="email" name="email" required className="w-full rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 px-3 py-2 outline-none focus:ring-2 focus:ring-fuchsia-400" />
              </div>
              <div>
                <label className="block text-sm mb-1">Message</label>
                <textarea name="message" rows={4} required className="w-full rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 px-3 py-2 outline-none focus:ring-2 focus:ring-fuchsia-400" />
              </div>
              <button className="inline-flex items-center gap-2 rounded-2xl px-4 py-2 text-sm font-medium border border-neutral-200 dark:border-neutral-800 bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 shadow-sm hover:shadow">
                Send Message <ArrowRight className="w-4 h-4" />
              </button>
            </form>
          </div>
          <div className="rounded-2xl border border-neutral-200 dark:border-neutral-800 p-6">
            <h3 className="font-semibold mb-4">Contact</h3>
            <ul className="space-y-3 text-sm text-neutral-600 dark:text-neutral-300">
              <li className="flex items-center gap-2"><Mail className="w-4 h-4" /> <a className="hover:underline" href={`mailto:${PROFILE.email}`}>{PROFILE.email}</a></li>
              <li className="flex items-center gap-2"><Phone className="w-4 h-4" /> <a className="hover:underline" href={`tel:${PROFILE.phone}`}>{PROFILE.phone}</a></li>
              <li className="flex items-center gap-2"><MapPin className="w-4 h-4" /> {PROFILE.location}</li>
              <li className="flex items-center gap-2"><Github className="w-4 h-4" /> <a className="hover:underline" target="_blank" rel="noreferrer" href={PROFILE.socials.github}>GitHub</a></li>
              <li className="flex items-center gap-2"><Linkedin className="w-4 h-4" /> <a className="hover:underline" target="_blank" rel="noreferrer" href={PROFILE.socials.linkedin}>LinkedIn</a></li>
              <li className="flex items-center gap-2"><Globe className="w-4 h-4" /> <a className="hover:underline" target="_blank" rel="noreferrer" href={PROFILE.socials.website}>Website</a></li>
            </ul>
            <p className="mt-6 text-xs text-neutral-500">Prefer WhatsApp or Telegram? Add it above and I’ll update this section.</p>
          </div>
        </div>
      </Section>

      {/* FOOTER */}
      <footer className="py-10 border-t border-neutral-200 dark:border-neutral-800 text-sm">
        <div className="max-w-6xl mx-auto px-6 flex flex-col sm:flex-row items-center justify-between gap-4">
          <p>© {new Date().getFullYear()} {PROFILE.name}. All rights reserved.</p>
          <div className="flex items-center gap-4">
            <a href="#home" className="hover:underline">Back to top</a>
          </div>
        </div>
      </footer>
    </div>
  );
}

/*
HOW TO USE / DEPLOY
1) Create a new Vite + React + Tailwind project (or Next.js) and paste this file into src/App.jsx (or a new component). Ensure Tailwind is configured and framer-motion + lucide-react are installed.

npm create vite@latest my-portfolio -- --template react
cd my-portfolio
npm i framer-motion lucide-react
npm i -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

Add to tailwind.config.js:
  content: ["./index.html", "./src/**/*.{js,ts,jsx,tsx}"]

Add the Tailwind directives to src/index.css:
  @tailwind base;@tailwind components;@tailwind utilities;

2) Replace PROFILE, SKILLS, PROJECTS, EXPERIENCE above with your info.
3) Add your resume file and point the Resume button to it.
4) Deploy free on Vercel/Netlify/GitHub Pages.
*/
